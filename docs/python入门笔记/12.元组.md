# 元组

Python的另外一种内置类型：元组。



# 元组不可修改

元组是一系列的值。这些值可以是任意类型的，并且用整数序号作为索引，元组和列表非常相似。二者间重要的区别就是元组是不可修改的。

元组的语法是一系列用逗号分隔的值：

```python
t = 'a', 'b', 'c', 'd', 'e'
```

通常都用一对圆括号把元组的元素包括起来：

```python
t = ('a', 'b', 'c', 'd', 'e')
```

要建立一个单个元素构成的元组，必须要在结尾加上逗号：

```python
>>> t1 = 'a',
>>> type(t1)
<class 'tuple'>
```

只用括号放一个值，并不是元组：

```python
>>> t2 = ('a')
>>> type(t2)
<class 'str'>
```

另一种建立元组的方法是使用内置函数tuple。不提供参数的情况下，默认就建立一个空的元组。

```python
>>> t = tuple()
>>> t
()
```

如果参数为一个序列（比如字符串、列表或者元组），结果就会得到一个以该序列元素组成的元组。

```python
>>> t = tuple('python')
>>> t
('p', 'y', 't', 'h', 'o', 'n')
```

tuple是内置函数名，所以不能用来作为变量名。

列表的各种运算符也基本适用于元组。方括号可以用来索引元素：

```python
>>> t = ('a', 'b', 'c', 'd', 'e')
>>> t[0]
'a'
>>> t[1:3]
('b', 'c')
```

因为元组是不可修改的，所以如果想修改元组中的某个元组，就会得到错误了：

```python
>>> t = ('a', 'b', 'c', 'd', 'e')
>>> t[0] ='A'
Traceback (most recent call last):
  File "<stdin>", line 1, in <module>
TypeError: 'tuple' object does not support item assignment
```

因为元组是不能修改的，你不能修改其中的元素。但是可以用另一个元组来替换已有的元组。下述语句建立了一个新的元组，然后让t指向了这个心的元组：

```python
>>> t = ('a', 'b', 'c', 'd', 'e')
>>> t = ('A',) + t[1:]
>>> t
('A', 'b', 'c', 'd', 'e')
```

关系运算符也适用于元组和其他序列；Python从每个元素的首个元素开始对比。如果相等，就对比下一个元素，依次类推，直到找到不同元素为止。（有了不同元素之后，后面的其他元素都被忽略掉了。）

```python
>>> (0, 1, 2) < (0, 3, 4)
True
```



## 元组赋值

对两个变量的值进行交换，是一种常用操作，一般来讲就需要一个临时变量，例如：下面这这个例子中是交换a和b两个变量：

```python
temp = a 
a = b 
b = temp
```

上述交换两个变量的值，用元组赋值就很简洁：

```python
>>> a, b = b, a
```

等号左边的是变量组成的一个元组；右边的是表达式的元组。每个值都被赋给了对应的变量。等号右边的表达式的值保留了赋值之前的初始值。

等号左右两侧的变量和值的数目都必须是一样的，否则就会出错：

```python
>>> a, b = 7, 8, 9
ValueError: too many values to unpack (expected 2)
```

更普适的情况，等号右边是以任意一种序列（字符串、列表或者元组）。比如，要把一个电子邮件地址转换成一个用户名和一个域名，可以用下面代码实现：

```python
addr = 'zhzhang09@126.com'
uname, domain = addr.split('@')
```

split的返回值是一个有两个元素的列表；第一个元素赋值给了uname这个变量，第二个赋值给了domain这个变量。

```python
>>> uname
'zhzhang09'
>>> domain
'126.com'
```



## 用元组做返回值

严格来讲，一个函数只能返回一个值，但如果这个值是一个元组，效果就和返回多个值一样了。

例如同时计算商和余数，内置函数divmod会接收两个参数，然后返回一个有两个值的元组，这两个值分别为商和余数。可以把结果存储为一个元组：

```python
>>> t = divmod(7, 3)
>>> t
(2, 1)
```

或者可以用元组赋值来分别存储这两个值：

```python
>>> quot, rem = divmod(7,3)
>>> quot
2
>>> rem
1
```

下述例子中，函数返回一个元组作为返回值：

```python
def min_max(t):
    return min(t), max(t)
```

max和min都是内置函数，会找到序列中的最大值或者最小值，min_max这个函数会同时求得最大值和最小值，然后把这两个值作为元组来返回。



## 参数长度可变的元组

函数的参数可以有任意多个。用星号*开头来作为形式参数名，可以将所有实际参数收录到一个元组中。例如printall就可以获取任意多个数的参数，然后打印：

```python
def printall(*args):
    print(args)
```

你可以随意命名收集来的这些参数，但args这个是约定俗成的惯例。下述展示一下这个函数如何使用：

```python
>>> printall(1, 2.0, 'python', [3, 4])
(1, 2.0, 'python', [3, 4])
```

与聚集相对的就是分散了。如果有一系列的值，然后想把它们作为多个参数传递给一个函数，就可以用星号*运算符。比如divmod要求必须是两个参数，如果传递一个元组，是不能进行运算的：

```python
>>> t = (7, 3)
>>> divmod(t)
Traceback (most recent call last):
  File "<stdin>", line 1, in <module>
TypeError: divmod expected 2 arguments, got 1
```

但如果拆分这个元组，就可以了：

```python
>>> divmod(*t)
(2, 1)
```

很多内置函数都用到了参数长度可变的元组。比如max和min就可以接收任意数量的参数：

```python
>>> max(1, 2, 3)
3
```

但求和函数sum就不行了：

```python
>>> sum(1,2,3)
TypeError: sum expected at most 2 arguments, got 3
```

做个练习，写一个名为sumall的函数，让它可以接收任意数量的参数，返回求和：

```python
def sumall(*args):
    sum = 0
    for num in args:
        sum += num
    return sum

>>> t = (1,2,3,4,5)
>>> sumall(*t)
15
```



## 列表和元组

zip是一个内置函数，接收两个或更多的序列作为参数，然后返回一个元组列表，该列表中每个元组都包含了从各个序列中的一个元素。这个函数名的意思就是拉锁，就是把不相关的两排拉锁齿连接到一起。

下面这个例子中，一个字符串和一个列表通过zip这个函数连接到了一起：zip函数的返回值是一个zip对象，该对象可以用来迭代所有的数值对。zip经常被用到for循环中：

```python
>>> s = 'abc'
>>> t = [0, 1, 2]
>>> zip(s, t)
<zip object at 0x10333a2c8>
>>> for pair in zip(s, t):
...     print(pair)
...
('a', 0)
('b', 1)
('c', 2)
```

zip对象是一种迭代器，也就是某种可以迭代整个序列的对象。迭代器和列表有些相似，但不同于列表的是，你无法通过索引来选择迭代器中的指定元素。

如果想用列表的运算符和方法，可以用zip对象来构成一个列表：

```python
>>> list(zip(s, t))
[('a', 0), ('b', 1), ('c', 2)]
```

返回值是一个由元组构成的列表；在上述例子中，每个元组都包含了字符串中的一个字母，以及列表中对应位置的元素。

在长度不同的序列中，返回的结果长度取决于最短的一个。

```python
>>> list(zip('bao', 'shan'))
[('b', 's'), ('a', 'h'), ('o', 'a')]
```

用for循环来遍历一个元组列表的时候，可以用元组赋值语句：

```python
>>> t = [('a', 0), ('b', 1), ('c', 2)]
>>> for letter, number in t:
...     print(number, letter)
...
0 a
1 b
2 c
```

如果结合使用zip、for循环以及元组赋值，就能得到一种能同时遍历两个以上序列的代码组合。如下述函数，接收两个序列t1和t2作为参数，如果存在一个索引位置i使得t1[i] == t2[i]就返回真：

```python
def has_match(t1, t2):
    for x, y in zip(t1, t2):
        if x == y:
            return True
    return False

print(has_match('123','321'))
```

如果要遍历一个序列中的所有元素以及它们的索引，可以用内置函数enumerate:

```python
>>> for index, element in enumerate('abc'):
...     print(index, element)
...
0 a
1 b
2 c
```

enumerate函数的返回值是一个枚举对象，它会遍历整个成对序列；每一对都包括一个索引（从0开始）以及给定序列的一个元素。



## 字典与元组

字典有一个名为items的方法，会返回一个由元组组成的序列，每一个元组都是字典中的一个键值对。

```python
>>> d = {'a':0, 'b':1, 'c':2}
>>> t = d.items()
>>> t
dict_items([('c', 2), ('a', 0), ('b', 1)])
>>> type(t)
<class 'dict_items'>
```

结果是一个dict_items对象，这是一个迭代器，迭代所有的键值对。可以在for循环里面用这个对象，如下所示：

```python
for key, value in d.items():
    print(key, value)
```

注：字典中的项是没有固定顺序的。

反过来使用的话，你就也可以用一个元组的列表来初始化一个新的字典。

```python
>>> t = [('c', 2), ('a', 0), ('b', 1)]
>>> d = dict(t)
>>> d
{'c': 2, 'a': 0, 'b': 1}
```

结合使用dict和zip，会得到一种建立字典的简便方法：

```python
>>> d = dict(zip('abc', range(3)))
>>> d
{'c': 2, 'a': 0, 'b': 1}
```

字典的update方法也接收一个元组列表，然后把它们作为键值对添加到一个已存在的字典中。

把元组用作字典中的键是很常见的做法（因为字典中的键是不能够被修改的，不能用列表，但元组是可以用作键的）。例如：

```python
directory[last, first] = number
```

方括号内的表达式是一个元组。我们可以用元组赋值语句来遍历这个字典：

```python
for last, first in directory:
    print(first, last, directory[last,first])
```

上面这个循环会遍历字典中的键，这些键都是元组。



## 由序列组成的序列

序列组成的序列：

- 列表组成的列表；
- 元组组成的元组；
- 列表组成的元组；

很多情况下，不同种类的序列（字符串、列表和元组）是可以交换使用的。

列表用的比元组更广泛，因为列表可以修改。但下述情况下，使用元组更好：

- 用元组来实现返回语句中的返回值，要比列表简单；

- 如果需要用一个序列作为字典的键，必须用元组或者字符串这样不可修改的类型才行；

- 如果要把一个序列作为参数传给一个函数，用元组能够降低由于别名使用导致未知情况而带来的风险；

元组是不可修改的，所以不提供sort和reverse这样的方法，这些方法都只能修改已经存在的列表。

但Python提供了内置函数sorted，该函数接收任意序列，然后返回一个把该序列中元素重新排序过的列表。另外还有个内置函数reversed，接收一个序列然后返回一个以逆序迭代整个列表的迭代器。



## 部分术语列表

- 元组：一列元素组成的不可修改的序列。

- 数据结构：一些有关系数据的集合体，通常是列表、字典或者元组等形式。



**重要的事情说三遍：练习！练习！练习！**

